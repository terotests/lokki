(function(){var n={},t=function(){var t=function(){!function(n){var t,e,i,o,r;n.add=function(n,t,i){if(t||i){var o;"[object Array]"===Object.prototype.toString.call(i)?o=i:(o=Array.prototype.slice.call(arguments,2),o||(o=[])),e.push([t,n,o])}else e.push(n)},n.after=function(n,t,e){e||(e="time"+(new Date).getTime()+Math.random(1e7)),o[e]={step:Math.floor(1e3*n),fn:t,nextTime:0,remove:!0}},n.asap=function(n){this.add(n)},n.every=function(n,t,e){e||(e="time"+(new Date).getTime()+Math.random(1e7)),o[e]={step:Math.floor(1e3*n),fn:t,nextTime:0}},n.__traitInit&&!n.hasOwnProperty("__traitInit")&&(n.__traitInit=n.__traitInit.slice()),n.__traitInit||(n.__traitInit=[]),n.__traitInit.push(function(){if(!t){this.polyfill();var n,a;if("undefined"!=typeof window){var n=window.requestAnimationFrame,a=window.cancelRequestAnimationFrame;["","ms","moz","webkit","o"].forEach(function(t){n||(n=window[t+"RequestAnimationFrame"],a=window[t+"CancelAnimationFrame"]||window[t+"CancelRequestAnimationFrame"])})}n||(n=function(n){return setTimeout(n,16)}),a||(a=function(n){clearTimeout(n)}),e=[],i={},o={},r=[];var l=0,s=function(){for(var t,a=(new Date).getTime();t=e.shift();)"[object Array]"===Object.prototype.toString.call(t)?t[1].apply(t[0],t[2]):t();for(var f=0;f<r.length;f++){var c=r[f];c()}for(var u in i)if(i.hasOwnProperty(u)){var _=i[u];_[0](_[1]),delete i[u]}for(var u in o)if(o.hasOwnProperty(u)){var _=o[u];_.nextTime<a&&(_.remove?_.nextTime>0?(_.fn(),delete o[u]):_.nextTime=a+_.step:(_.fn(),_.nextTime=a+_.step)),_.until&&_.until<a&&delete o[u]}n(s),l=a};s(),t=!0}}),n.once=function(n,t,e){i[n]=[t,e]},n.onFrame=function(n){r.push(n)},n.polyfill=function(){},n.removeFrameFn=function(n){var t=r.indexOf(n);return t>=0?(n._onRemove&&n._onRemove(),r.splice(t,1),!0):!1}}(this)},e=function(n,t,i,o,r,a,l,s){var f,c=this;if(!(c instanceof e))return new e(n,t,i,o,r,a,l,s);var u=[n,t,i,o,r,a,l,s];if(c.__factoryClass)if(c.__factoryClass.forEach(function(n){f=n.apply(c,u)}),"function"==typeof f){if(f._classInfo.name!=e._classInfo.name)return new f(n,t,i,o,r,a,l,s)}else if(f)return f;c.__traitInit?c.__traitInit.forEach(function(n){n.apply(c,u)}):"function"==typeof c.init&&c.init.apply(c,u)};e._classInfo={name:"later"},e.prototype=new t;var i=function(){!function(n){n.guid=function(){return Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15)},n.isArray=function(n){return n instanceof Array},n.isFunction=function(n){return"[object Function]"==Object.prototype.toString.call(n)},n.isObject=function(n){return n===Object(n)}}(this),function(n){var t,i,o,r,a;n.hasOwnProperty("__factoryClass")||(n.__factoryClass=[]),n.__factoryClass.push(function(n){return n?(t||(t={}),t[n]?t[n]:void(t[n]=this)):void 0}),n._initLogRefresh=function(n){if("undefined"!=typeof global&&"undefined"!=typeof process&&!r){o||(o=require("fs"));var t=n.logFileRefresh||60;r=!0;var a=this;e().every(t,function(){o.readFile(n.logSettingsFile,"utf8",function(n,t){if(!n)try{var e=JSON.parse(t);if(e&&e.enable)for(var o in e.enable)e.enable.hasOwnProperty(o)&&(i[o]=e.enable[o]);if(e)for(var o in e)if(e.hasOwnProperty(o)){if("enable"==o)continue;a._options[o]=e[o]}}catch(r){}})})}},n.addMetrics=function(n,t){if(i[this._tag]){var e=this._metrics[n];e||(e=this._metrics[n]={cnt:0,latest:t,min:t,max:t,total:0}),t=1*t,isNaN(t)||(e.cnt++,e.total+=t,e.latest=t,e.max<t&&(e.max=t),e.min>t&&(e.min=t),e.avg=e.total/e.cnt)}},n.enable=function(n){if(n&&n)for(var t in n)n.hasOwnProperty(t)&&(i[t]=n[t])},n.__traitInit&&!n.hasOwnProperty("__traitInit")&&(n.__traitInit=n.__traitInit.slice()),n.__traitInit||(n.__traitInit=[]),n.__traitInit.push(function(n,t){t=t||{},this._tag=n,this._log=[],a||(a={}),this._options=a,"undefined"!=typeof global&&"undefined"!=typeof process&&(this._isNode=!0);for(var r in t)"enable"!=r&&t.hasOwnProperty(r)&&(a[r]=t[r]);if(t.logInterval=t.logInterval||1,t.metricsInterval=t.metricsInterval||10,this._metrics={},i||(i={}),t.enable)for(var r in t.enable)t.enable.hasOwnProperty(r)&&(i[r]=t.enable[r]);t.logSettingsFile&&this._initLogRefresh(t);var l=this,s=function(){if(i[l._tag]&&0!=l._log.length){if(l._options.logFile&&l._isNode){o||(o=require("fs"));var n="";l._log.forEach(function(t,e){e>0&&(n+="\n"),t.forEach(function(t,e){return e>0&&(n+=","),l.isObject(t)?void(n+="[Object]"):l.isArray(t)?void(n+="[Array]"):void(n+=JSON.stringify(t))})}),n+="\n",o.appendFile(l._options.logFile,n,function(){})}if(l._options.console){if(!console.group)return console.log("--- "+l._tag+" ----- "),l._log.forEach(function(n){1==n.length&&console.log(n[0]),2==n.length&&console.log(n[0],n[1]),3==n.length&&console.log(n[0],n[1],n[2]),4==n.length&&console.log(n[0],n[1],n[2],n[3])}),void(l._log.length=0);console.group(l._tag),l._log.forEach(function(n){1==n.length&&console.log(n[0]),2==n.length&&console.log(n[0],n[1]),3==n.length&&console.log(n[0],n[1],n[2]),4==n.length&&console.log(n[0],n[1],n[2],n[3])}),console.groupEnd()}l._log.length=0}},f=function(){if(i[l._tag]&&l._options.console){if(l._logMemoryCnt&&l._logMemoryCnt>0&&(l._logMemoryCnt--,process&&process.memoryUsage)){var n=(require("util"),process.memoryUsage());l.value("rss",n.rss),l.value("heapTotal",n.heapTotal),l.value("heapUsed",n.heapUsed),l.value("heapUsage",parseInt(100*n.heapUsed/n.heapTotal)),l.value("fromTotalGb",parseFloat(100*n.heapTotal/1073741824).toFixed(2))}if(console&&console.group)console.group("Metrics"),console.table(l._metrics,["cnt","latest","min","max","avg"]),console.groupEnd();else{var t=0;for(var e in l._metrics){t++,1==t&&console.log("=== node.js METRICS ===");var n=l._metrics[e];console.log(e,n.cnt,n.latest,n.min,n.max,n.avg)}}}};e().every(t.logInterval,s),e().every(t.metricsInterval,f)}),n.log=function(){if(i[this._tag]){for(var n=[],t=0;t<arguments.length;t++)n.push(arguments[t]);this._log.push(n)}},n.recordHeap=function(n){this._logMemoryCnt=n},n.settings=function(n){if(n&&n)for(var t in n)n.hasOwnProperty(t)&&(i[t]=n[t])},n.value=function(n,t){this.addMetrics(n,t)}}(this)},o=function(n,t,e,i,r,a,l,s){var f,c=this;if(!(c instanceof o))return new o(n,t,e,i,r,a,l,s);var u=[n,t,e,i,r,a,l,s];if(c.__factoryClass)if(c.__factoryClass.forEach(function(n){f=n.apply(c,u)}),"function"==typeof f){if(f._classInfo.name!=o._classInfo.name)return new f(n,t,e,i,r,a,l,s)}else if(f)return f;c.__traitInit?c.__traitInit.forEach(function(n){n.apply(c,u)}):"function"==typeof c.init&&c.init.apply(c,u)};o._classInfo={name:"lokki"},o.prototype=new i,function(){"undefined"!=typeof define&&null!==define&&null!=define.amd?(n.lokki=o,this.lokki=o):"undefined"!=typeof module&&null!==module&&null!=module.exports?module.exports.lokki=o:this.lokki=o}.call(new Function("return this")()),function(n){n.__traitInit&&!n.hasOwnProperty("__traitInit")&&(n.__traitInit=n.__traitInit.slice()),n.__traitInit||(n.__traitInit=[]),n.__traitInit.push(function(){})}(this)},e=function(n,t,i,o,r,a,l,s){var f,c=this;if(!(c instanceof e))return new e(n,t,i,o,r,a,l,s);var u=[n,t,i,o,r,a,l,s];if(c.__factoryClass)if(c.__factoryClass.forEach(function(n){f=n.apply(c,u)}),"function"==typeof f){if(f._classInfo.name!=e._classInfo.name)return new f(n,t,i,o,r,a,l,s)}else if(f)return f;c.__traitInit?c.__traitInit.forEach(function(n){n.apply(c,u)}):"function"==typeof c.init&&c.init.apply(c,u)};e._classInfo={name:"lokkiLoki"},e.prototype=new t,function(){"undefined"!=typeof define&&null!==define&&null!=define.amd?(n.lokkiLoki=e,this.lokkiLoki=e):"undefined"!=typeof module&&null!==module&&null!=module.exports?module.exports.lokkiLoki=e:this.lokkiLoki=e}.call(new Function("return this")()),"undefined"!=typeof define&&null!==define&&null!=define.amd&&define(n)}).call(new Function("return this")());